<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=s, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

</body>
<script src="./json.js"></script>
<script>

    // 递归累加=====================3+2+1

    function add(n) {
        console.log(n);
        if (n === 1) {
            // 此处理解为到达了临界点，拿到了确定的值1(因为add(1) == 1)，开始原路返回
            return 1;
        }
        return n + add(n - 1)
    }
    // console.log(add(3));
    // 解析
    // 3+add(3-1) = 3+add(2) //此时不能计算3+add(2)，还需要近一步计算add(2)里面的值依次类推
    // 3+add(2) add(2) = 2+add(1)   add(1) = 1
    // 连起来就是 3+2+1




    // ============================写个冒泡排序
    var arr = [1, 3, 5]
    for (let i = 0; i < arr.length; i++) {
        for (let j = i + 1; j < arr.length; j++) {
            if (arr[i] < arr[j]) {
                //就是换位置
                let temp = arr[i];
                arr[i] = arr[j];
                arr[j] = temp;
            }
        }
    }

    // ===========================递归取值

    var goods_arr = [
        {
            id: '1',
            name: '电器',
            goods: [
                {
                    id: 11,
                    name: '洗衣机',
                    goods: [
                        {
                            id: 111,
                            name: '海尔'
                        },
                        {
                            id: 112,
                            name: '美的'
                        }
                    ]
                },
                {
                    id: 12,
                    name: '电视'
                }
            ]
        },
        {
            id: 2,
            name: '衣服类'
        }
    ]
    function getid(data, id) {
        let o = {};
        data.forEach(item => {
            if (item.id == id) {
                o = item
            } else if (item.goods && item.goods.length) {
                o = getid(item.goods, id)
            }
        });
        return o;
    }

    // console.log(getid(goods_arr, 112));


    // ================================深拷贝

    var obj = {
        name: 'cc',
        id: 1,
        msg: {
            age: 18,
            fn: function () {

            }
        },
        color: ['red', 'black']
    }
    var o = {};

    function deep(new_obj, old_obj) {
        for (let name in old_obj) {
            let item = old_obj[name];
            if (item instanceof Array) { //必须先判断数组  因为数组instanceof 也属于object
                new_obj[name] = [];
                deep(new_obj[name], old_obj[name]) //new_obj[name] 这里其实是传入的一个指向，不要理解为传入了数组
            } else if (item instanceof Object) {
                new_obj[name] = {}
                deep(new_obj[name], old_obj[name])
            } else {
                new_obj[name] = item;
            }
        }
        return new_obj;
    }

    // console.log(deep(o,obj));

    function GetObj(val){
        return Object.prototype.toString.call(val) === "[object Object]"
    }
    function GetArr(val){
        return Object.prototype.toString.call(val) === "[object Array]"
    }
    function deep2(val){
        let rs;
        if(val == undefined || val == null) return val;
        if(!GetObj(val) && !GetArr(val)) return val;
        if(GetObj(val)){
            rs = {}
        }
        if(GetArr(val)){
            rs = []
        }
        for(let name in val){
            rs[name] = deep2(val[name])
        }
        return rs

    }
    // console.log(deep2(obj));

    // 象棋盘放麦子  主要是0次方为1
    let startNum = 2;//开始数
    let fang = 0; //次方
    let result = 0;
    function a() {
        if (fang === 65) {
            return
        }
        result += Math.pow(startNum, fang);
        fang++;
        a()
    }
    a()


    //斐波那契数列  1 1 2 3 5 8 13
    function b(num) {
        let arr = [];
        if (num == 1) {
            arr = [1]
        } else if (num == 2) {
            arr = [1, 1]
        } else {
            arr = [1, 1];
            let a;
            for (let i = 2; i < num; i++) {
                a = arr[i - 2] + arr[i - 1]
                arr.push(a);
            }
            // let a,b=1;
            // let c = 2;
            // for (let i = 2; i < num; i++) {
            //     arr.push(c);
            //     a = b;
            //     b = c;
            //     c = a + b;
            // }
        }
    }
    b(7)

    // function fb(n) {
    //     if (n == 1 || n == 2) {
    //         return 1;
    //     }
    //     return fb(n - 1) + fb(n - 2);
    // }
    // fb(4) + fb(3)
    // fb(3) + fb(2) + fb(2) + fn(1)
    // fb(2) + fn(1) + fb(2) + fb(2) + fn(1)
    // console.log(fb(5));



    // 排列组合
    var str = [1, 2, 3];
    var count = 0;
    function arrange(s) {
        for (var i = 0, length = str.length; i < length; i++) {
            if (s.length == length - 1) {
                if (s.indexOf(str[i]) < 0) {
                    count++;
                    console.log("组合" + count + "=" + s + str[i]);
                }
                continue;
            }
            if (s.indexOf(str[i]) < 0) {
                arrange(s + str[i]);
            }
        }
    }

    // arrange('')



    // categoryLevel = 3
    // function remove(arr) {
    //     let result_arr = [];
    //     for (let i = 0; i < arr.length; i++) {
    //         let item = arr[i];
    //         if (item.children && item.children.length || item.categoryLevel == 3) { //item.categoryLevel == 3 只显示name
    //             let children = [];
    //             let res = remove(item.children);
    //             if (res.length) {
    //                 children.push(res)
    //             }
    //             if (children.length) {
    //                 result_arr.push({
    //                     name: item.categoryName,
    //                     children
    //                 })
    //             } else {
    //                 if (!(item.categoryLevel < 3)) {
    //                     result_arr.push({
    //                         name: item.categoryName,
    //                     })
    //                 }
    //             }
    //         }
    //     }
    //     return result_arr;
    // }
    // remove(data_arr)
    // console.log(remove(data_arr));








    // ===============================自己写的
    // 递归不仅有递下去，还有归来的概念，当不满足条件时，停止递下去，开始归来程序（重要的是归来理解，不断的回滚，不断拿到前一个回滚的值）
    // 所以需要以倒叙方式思考，从最底层思考
    // 到达临界点，原路返回
    function remove(arr) {
        let newarr = [];
        for (let i = 0; i < arr.length; i++) {
            let item = arr[i];
            if (item.children && item.children.length || item.categoryLevel === 3) {
                // console.log(item.categoryName + item.categoryLevel);
                let rs = remove(item.children)
                let children = [];
                if (item.categoryLevel === 3) { //当是最后自己想要的那级时，组装新的数组，此处理解为临界点，开始原路返回
                    newarr.push({
                        name: item.categoryName,
                        categoryLevel: item.categoryLevel
                    })
                }
                if (rs.length) {
                    children.push(rs)
                }
                if (children.length) {
                    newarr.push({
                        name: item.categoryName,
                        categoryLevel: item.categoryLevel,
                        children
                    })
                }
            }
        }
        return newarr
    }

    // console.log(remove(data_arr));



    // var cc = [
    //     {
    //         name: '1',
    //         level: 1,
    //         children: [
    //             {
    //                 level: 2,
    //                 name: '11',
    //                 children: [
    //                     { name: '111', level: 3 }
    //                 ]
    //             },
    //             {
    //                 name: '22',
    //                 level: 2,
    //             }
    //         ]
    //     },
    //     {
    //         name: '2',
    //         level: 1,
    //         children: [
    //             {
    //                 level: 2,
    //                 name: '221',
    //                 children: [
    //                     { name: '2221', level: 3 }
    //                 ]
    //             },
    //             {
    //                 name: '222',
    //                 level: 2,
    //             }
    //         ]
    //     }
    // ]

    // function test(arr) {
    //     if (arr === undefined) return [];
    //     let newarr = [];
    //     for (let i = 0; i < arr.length; i++) {
    //         if (arr[i].children && arr[i].children.length || arr[i].level ) {
    //             let item = arr[i];
    //             let rs = test(item.children);
    //             let children = [];

    //             if (arr[i].level === 3) {
    //                 newarr.push({
    //                     name: item.name
    //                 })
    //             }
    //             if (rs.length) {
    //                 children.push(rs)
    //             }
    //             if (children.length) {
    //                 newarr.push({
    //                     name: item.name,
    //                     children
    //                 })
    //             }
    //         }
    //     }
    //     return newarr;
    // }

    // let rs = test(cc)
    // console.log(rs);






</script>

</html>